---

import Section from "../../layouts/Section.astro";

---

<Section id="timeline" class="bg-secondary" addBottomPadding={false}>
  <svg class="w-full" width="768" height="2378" viewBox="0 0 768 2378" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g id="lineFrame" opacity="0.9">
    <g id="paths">
    <path id="tline" d="M704 14C704 84.164 647.056 141.009 576.893 140.888L204 140.242C126.719 140.109 64 202.719 64 280C64 357.32 126.68 420 204 420H564C641.32 420 704 482.68 704 560C704 637.044 641.544 699.5 564.5 699.5H203.5C126.456 699.5 64 761.956 64 839C64 916.32 126.68 979 204 979H564C641.32 979 704 1041.68 704 1119C704 1196.32 641.32 1259 564 1259H204C126.68 1259 64 1321.68 64 1399C64 1476.32 126.68 1539 204 1539H564C641.32 1539 704 1601.68 704 1679C704 1756.04 641.544 1818.5 564.5 1818.5H203.5C126.456 1818.5 64 1880.96 64 1958C64 2035.32 126.68 2098 204 2098H564C641.32 2098 704 2160.68 704 2238" stroke="white" stroke-width="14" stroke-linecap="round" style="stroke-dasharray: 6391; stroke-dashoffset: 1501px;"></path>
    </g>
    <g id="ball containers">
    <g id="Frame 76">
    <circle id="tcirc1" cx="64" cy="280" r="30" fill="white" data-svg-origin="64 280" style="transform-origin: 0px 0px; opacity: 1;" transform="matrix(1,0,0,1,0,0)"></circle>
    </g>
    <g id="Frame 77">
    <circle id="tcirc2" cx="704" cy="560" r="30" fill="white" data-svg-origin="704 560" style="transform-origin: 0px 0px; opacity: 1;" transform="matrix(1,0,0,1,0,0)"></circle>
    </g>
    <g id="Frame 78">
    <circle id="tcirc3" cx="64" cy="839" r="30" fill="white" data-svg-origin="64 839" style="transform-origin: 0px 0px; opacity: 1;" transform="matrix(1,0,0,1,0,0)"></circle>
    </g>
    <g id="Frame 79">
    <circle id="tcirc4" cx="704" cy="1119" r="30" fill="white" data-svg-origin="704 1119" style="transform-origin: 0px 0px; opacity: 1;" transform="matrix(1,0,0,1,0,0)"></circle>
    </g>
    <g id="Frame 80">
    <circle id="tcirc5" cx="64" cy="1399" r="30" fill="white" data-svg-origin="64 1399" style="transform-origin: 0px 0px; opacity: 1;" transform="matrix(1,0,0,1,0,0)"></circle>
    </g>
    <g id="Frame 81">
    <circle id="tcirc6" cx="704" cy="1679" r="30" fill="white" data-svg-origin="704 1679" style="transform-origin: 0px 0px; opacity: 1;" transform="matrix(1,0,0,1,0,0)"></circle>
    </g>
    <g id="Frame 82">
    <circle id="tcirc7" cx="64" cy="1958" r="30" fill="white" data-svg-origin="64 1958" style="transform-origin: 0px 0px; opacity: 0;" transform="matrix(0,0,0,0,64,1958)"></circle>
    </g>
    <g id="Frame 83">
    <circle id="tcirc8" cx="704" cy="2238" r="30" fill="white" data-svg-origin="704 2238" style="transform-origin: 0px 0px; opacity: 0;" transform="matrix(0,0,0,0,704,2238)"></circle>
    </g>
    </g>
    </g>
    </svg>
</Section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const theLineElements = document.querySelectorAll(".timeline__line path") as NodeListOf<SVGPathElement>;

  theLineElements.forEach((lineElement) => {
    const totalLength = Math.floor(lineElement.getTotalLength()) + 1;

    gsap.set(lineElement, {
      strokeDashoffset: totalLength,
      strokeDasharray: totalLength,
    });

    gsap.to(lineElement, {
      strokeDashoffset: 0,
      scrollTrigger: {
        trigger: lineElement,
        start: "top 70%",
        end: "bottom 70%",
        scrub: 0.2,
      },
      ease: "linear",
    });
  });
</script>